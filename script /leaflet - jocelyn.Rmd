---
title: "Leaflet"
author: "Jocelyn Martinez Rico"
date: "4/12/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r, echo=FALSE}
library(leaflet)
library(tidyverse)
library(dplyr)
```

# Adding markers to maps

First we start with the base function to create a map.
```{r}
leaflet() %>%
  addTiles()
```

Then we can pin point on any given location using lat and long data, here is an example using Toya volcano in Japan. 

Icon markers can be added using the addMarkers or addAwesomeMarkers function.

Both functions work the same but differ in that the addAwesomeMarkers function allows you to use additional custom colors or icons from Font Awesome, Bootstrap Glyphicons, and Ion icons icon libraries.

```{r}
leaflet(data) %>%
  addTiles() %>%
  addMarkers(lng = 140.839, #longitude value
             lat = 42.544) #latitude value

# example using addAwesomeMarkers
#leaflet(data = volcano) %>%
#  addTiles() %>%
#  addAwesomeMarkers(lng = 131.600, 
#                    lat = 34.500)
```

Interactive pop up labels can also be added to existing markers. Using the popup feature displays designated label when clicked on the marker.
```{r}
leaflet(data) %>%
  addTiles() %>%
  addMarkers(lng = 140.8390, #longitude value
             lat = 42.544, #latitude value
             popup = "Toya volcano") #label name
```

Using the label option adds a hover feature to your label.

```{r}
leaflet(data) %>%
  addTiles() %>%
  addMarkers(lng = 140.839, #longitude value
             lat = 42.544, #latitude value
             label = "Toya volcano") #label name
```

# Customizing marker icons

Markers can be customized in any way, using any icon, image, or color.

For this example, we'll use the [leaflet icon](https://leafletjs.com/SlavaUkraini/examples/custom-icons/leaf-green.png).

To do this we'll create a function for our icon to make our code cleaner. Icon elements can be changed using icon and shadow functions. Icon functions are the base elements for customizing your icon and shadow functions add a 3D element to your icon.
```{r}
LeafIcon <- makeIcon( 
  iconUrl = "https://leafletjs.com/SlavaUkraini/examples/custom-icons/leaf-green.png", #leaf url
  iconWidth = 35, iconHeight = 95, #icon dimensions
  iconAnchorX = 20, iconAnchorY = 95, #iicon position dimensions
  shadowUrl = "https://leafletjs.com/SlavaUkraini/examples/custom-icons/leaf-shadow.png", #shadow url
  shadowWidth = 50, shadowHeight = 65, #shadow dimensions
  shadowAnchorX = 5, shadowAnchorY = 65 #icon position dimensions
  )
```

```{r}
leaflet(data) %>%
  addTiles() %>%
  addMarkers(lng = 140.839, #longitude value
             lat = 42.544, #latitude value
             icon = LeafIcon) #name for icon code
```

If you have more than one icon or point, the icons function is used to add more than one icon onto your map.

```{r}
leafs <- icons(
  iconUrl = "https://leafletjs.com/SlavaUkraini/examples/custom-icons/leaf-green.png", #leaf icon
  iconWidth = 35, iconHeight = 95, #icon dimensions
  iconAnchorX = 20, iconAnchorY = 95, #icon position dimensions
  shadowUrl = "https://leafletjs.com/SlavaUkraini/examples/custom-icons/leaf-shadow.png", #shadow icon
  shadowWidth = 50, shadowHeight = 65, #shadow dimensions
  shadowAnchorX = 5, shadowAnchorY = 65 #shadow position dimensions
  )
```

```{r}
longitudeval <- c(140.281, 145.030, 130.657, 144.013, 140.799) #5 longitude values
latitudeval <- c(37.647, 20.420, 31.593, 43.384, 39.761) #5 latitude values
```

```{r}
leaflet(data) %>%
  addTiles() %>%
  addMarkers(lng = longitudeval, #longitude function
             lat = latitudeval, #latitude function
             icon = leafs) #name for multiple icons code
```

# Customizable Icons with Awesome Icons

Using the addAwesomeMarkers function, markers can be customized through their color and icons.

View more icons [here](https://ionic.io/ionicons).

```{r}
volcano_icon <- awesomeIcons(
  icon = "flame", #icon name
  iconColor = "red", #icon color
  library = "ion", #library where the icon is from
  markerColor = "white" #marker color
)
```

```{r}
leaflet(data) %>%
  addTiles() %>%
  addAwesomeMarkers(lng = longitudeval, #longitude function
                    lat = latitudeval, #latitude function
                    icon = volcano_icon) #name for icon function
```

# Marker Clusters

For many markers grouped together on a single map, the cluster function can be used to group together several markers into one.

```{r}
# 10 long and lat values for volcanoes in japan
longitudevals <- c(140.281, 145.030, 130.657, 144.013, 140.799, 145.670, 138.523, 131.104, 140.244, 146.252)
latitudevals <- c(37.647, 20.420, 31.593, 43.384, 39.761, 16.350, 36.406, 32.884, 37.735, 44.353)
```

```{r}
leaflet(data) %>% 
  addTiles() %>% 
  addMarkers(lng = longitudevals, #longitude function
             lat = latitudevals, #latitude function
             clusterOptions = markerClusterOptions()) #code for cluster option
```

# Circle Markers

Instead of the standard bubble markers, you can opt for circle markers.

```{r}
leaflet(data) %>% 
  addTiles() %>%
  addCircleMarkers(lng = longitudevals, #simple circle marker, longitude function
                   lat = latitudevals) #latitude function
```

Circle markers can be customized by their color and opacity among others. 

```{r}
colpal <- c("#FB7110", "#4D1104") #color palette function

leaflet(data) %>% 
  addTiles() %>%
  addCircleMarkers(lng = longitudevals, #simple circle marker, longitude function
                   lat = latitudevals, #latitude function
                   color = colpal, #color palette
                   stroke = FALSE, #circle border
                   fillOpacity = 0.5) #circle opacity
```

